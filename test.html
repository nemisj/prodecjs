<html>
	<head>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
		<script src="prodec.js"></script>
		<script>
			function setDec(data) {
				var dec = document.getElementById("dec");
				dec && (dec.value = data);
				doDec = true;
			}

			function setTest(data) {
				var test = document.getElementById("test");
				test && (test.value = data);
			}

			function clearOutput() {
				var output = document.getElementById("output");
				output && (output.value = '');
			}

			function clean() {
				setDec('');
				setTest('');
				clearOutput();
			}

			function exec(str) {
				window.eval(str);
			}

			function debug(str) {
				var output = document.getElementById("output");
				output.value += (str + "\n");
			}

			function load(nr) {

				nr = nr || 1;
				jQuery.ajax({ 
					url     : "test-dec-" + nr + ".js", 
					success : setDec,
					error   : clean
				});

				jQuery.ajax({ 
					url     : "test-test-" + nr +".js", 
					success : setTest,
					error   : clean
				});

				clean();
			}

			doDec = true;


			function decChanged() {
				doDec = true;
			}


			function run() {
				clearOutput();

				if (doDec) {
					doDec = false;
					var dec = document.getElementById("dec");
					dec && exec(dec.value);
				}


				var test = document.getElementById("test");
				test && exec(test.value);		
			}

            $(function(){

                load(2);

                $("textarea").keypress(function(e) {
                    if (e.keyCode === 9) {
                        return false;
                    }
                });
            });
		</script>
	</head>

	<body>
		<div style="float:left">
			Declaration : <br/>
			<textarea onchange="decChanged()" id="dec" cols="40" rows="30">Loading...</textarea>
		</div>

		<div style="float:left">
			Test : <br/>
			<textarea id="test" cols="40" rows="30">Loading...</textarea>
		</div>

		<div style="float:left">
			Output : <br/>
			<textarea id="output" cols="40" rows="30"></textarea>
		</div>

		<div style="clear:both">
			This will run test.
			<button onclick="run()">Run</button>
			<button onclick="load(1)">Declare based</button>
			<button onclick="load(2)">Prototype based</button>
		</div>
	</body>
</html>
